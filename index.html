<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Excel MCQ Test - 30 Questions</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;font-family:Arial,sans-serif}
    body{background:#f0f2f5;display:flex;justify-content:center;padding:20px}
    .container{max-width:750px;width:100%;background:white;border-radius:15px;padding:30px;box-shadow:0 10px 30px rgba(0,0,0,0.1);margin:20px auto;text-align:center}
    h1,h2{color:#2c3e50;margin-bottom:20px}
    input,button{width:100%;padding:15px;margin:12px 0;border-radius:10px;border:1px solid #ddd;font-size:17px}
    button{background:#27ae60;color:white;cursor:pointer;font-size:19px;font-weight:bold}
    }
    button:hover{background:#1e8449}
    .option{margin:15px 0;padding:15px;background:#f8f9fa;border-radius:10px;cursor:pointer;font-size:16px}
    .option input{margin-right:12px}
    #timerMsg{font-size:19px;color:#c0392b;margin-top:20px;font-weight:bold}
  </style>
</head>
<body>

  <div class="container" id="startScreen">
    <h1>Excel MCQ Test (30 Questions)</h1>
    <p><strong>Test Start Time:</strong> <span id="startTimeDisplay"></span></p>
    <input type="text" id="studentName" placeholder="अपना पूरा नाम लिखें" required />
    <input type="text" id="studentClass" placeholder="कक्षा (जैसे 10th A)" required />
    <input type="text" id="rollNo" placeholder="रोल नंबर" required />
    <button id="startBtn">टेस्ट शुरू करें</button>
    <p id="timerMsg"></p>
  </div>

  <div class="container" id="quizScreen" style="display:none">
    <h2>प्रश्न <span id="currentQ">1</span>/30</h2>
    <div id="question" style="font-size:19px;margin:30px 0"></div>
    <div id="options"></div>
    <button id="nextBtn">अगला प्रश्न →</button>
  </div>

  <div class="container" id="resultScreen" style="display:none">
    <h1>धन्यवाद! टेस्ट सफलतापूर्वक जमा हो गया</h1>
    <p>नाम: <strong id="finalName"></strong></p>
    <p>स्कोर: <strong id="finalScore"></strong>/30</p>
    <p>प्रतिशत: <strong id="finalPercent"></strong></p>
  </div>

<script>
// ==== SET THESE TWO THINGS ONLY ====
const WEB_APP_URL (tumhara wahi jo diya tha)
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwxqo9BmWtPdAFBtNqllSvKt10Yq8nJ_JQ3o6dANcyPMnOkXB54VkgXYBmY1KObmnnScg/exec";

// ==== TEST START TIME CHANGE KAR DO (India time mein) ====
const TEST_START_TIME = new Date("2025-12-04 10:00:00").getTime();   // ← YAHAN DATE AUR TIME BADAL DENA

const questions = [
  {q:"Excel में किसी cell का address क्या कहलाता है?", o:["Cell Name","Cell Reference","Cell Pointer","None"], a:1},
  {q:"Latest Excel में कुल कितनी rows होती हैं?", o:["1,048,576","65,536","16,384","1,00,000"], a:0},
  {q:"Freeze Panes का काम क्या है?", o:["Row/Column fix करना","Data delete करना","Print करना","Chart बनाना"], a:0},
  {q:"=SUM(A1:A10) का मतलब?", o:["A1 से A10 तक जोड़ना","औसत निकालना","गिनती करना","Text जोड़ना"], a:0},
  {q:"VLOOKUP का पूरा नाम?", o:["Vertical Lookup","Very Large Lookup","Value Lookup","None"], a:0},
  {q:"Ctrl + ; दबाने से क्या होता है?", o:["आज की तारीख","समय","दोनों","कुछ नहीं"], a:0},
  {q:"Conditional Formatting कहाँ मिलती है?", o:["Home Tab","Insert Tab","Data Tab","View Tab"], a:0},
  {q:"Pivot Table का shortcut?", o:["Alt+N+V","Ctrl+T","Alt+D+P","कोई नहीं"], a:0},
  {q:"Filter लगाने का shortcut?", o:["Ctrl+Shift+L","Ctrl+F","Alt+A+T","Ctrl+D"], a:0},
  {q:"Excel फाइल का extension?", o:[".xlsx",".docx",".pptx",".txt"], a:0},
  {q:"=AVERAGE() फॉर्मूला क्या करता है?", o:["औसत","जोड़","गिनती","बड़ा number"], a:0},
  {q:"Ctrl + D का काम?", o:["नीचे की cell fill","ऊपर copy","दायें copy","delete"], a:0},
  {q:"Chart बनाने के लिए tab?", o:["Insert","Home","Data","Page Layout"], a:0},
  {q:"Sort करने के लिए?", o:["Data Tab → Sort","Home → Sort","View → Sort","कोई नहीं"], a:0},
  {q:"=COUNT() क्या गिनता है?", o:["संख्या वाली cells","सभी cells","खाली cells","text"], a:0},
  {q:"IF formula का syntax?", o:["=IF(condition,true,false)","=IFTRUE","=WHEN","कोई नहीं"], a:0},
  {q:"Print preview कहाँ मिलता है?", o:["File → Print","Ctrl+P","दोनों","View Tab"], a:2},
  {q:"Header & Footer कहाँ डालते हैं?", o:["Insert Tab","View Tab","Page Layout","Home"], a:0},
  {q:"Ctrl + Shift + $ से क्या होता है?", o:["Currency format","Percentage","Date","Text"], a:0},
  {q:"Data validation कहाँ मिलता है?", o:["Data Tab","Home Tab","Insert","Review"], a:0},
  {q:"=TODAY() function क्या देता है?", o:["आज की तारीख","समय","दोनों","कुछ नहीं"], a:0},
  {q:"Wrap text का बटन कहाँ है?", o:["Home Tab","Insert","View","Page Layout"], a:0},
  {q:"Merge & Center कहाँ है?", o:["Home Tab","Insert","Data","View"], a:0},
  {q:"Find & Replace का shortcut?", o:["Ctrl+F","Ctrl+H","Ctrl+R","Alt+F"], a:1},
  {q:"Protect sheet का option?", o:["Review Tab","Data Tab","Home","View"], a:0},
  {q:"Hyperlink डालने के लिए?", o:["Ctrl+K","Ctrl+L","Alt+H","Insert Tab"], a:0},
  {q:"=PROPER() function क्या करता है?", o:["पहला अक्षर बड़ा","सब बड़ा","सब छोटा","कोई नहीं"], a:0},
  {q:"Page break preview mode?", o:["View Tab","Page Layout","Insert","Status bar"], a:0},
  {q:"Goal Seek कहाँ मिलता है?", o:["Data → What-If Analysis","Formulas","Home","Review"], a:0},
  {q:"Excel में maximum columns कितने होते हैं?", o:["16,384","1","65,536","1,048,576","कोई सीमा नहीं"], a:0}
];

let currentQuestion = 0, score = 0, selectedAnswers = [], studentInfo = {};

document.getElementById('startTimeDisplay').textContent = new Date(TEST_START_TIME).toLocaleString('en-IN');

document.getElementById('startBtn').onclick = () => {
  const now = new Date().getTime();
  if (now < TEST_START_TIME) {
    let diff = TEST_START_TIME - now;
    let h = Math.floor(diff / 3600000);
    let m = Math.floor((diff % 3600000) / 60000);
    document.getElementById('timerMsg').innerHTML = `टेस्ट ${h} घंटे ${m} मिनट बाद शुरू होगा`;
    return;
  }
  studentInfo.name = document.getElementById('studentName').value.trim();
  studentInfo.class = document.getElementById('studentClass').value.trim();
  studentInfo.roll = document.getElementById('rollNo').value.trim();
  if (!studentInfo.name || !studentInfo.class || !studentInfo.roll) return alert("सारी जानकारी भरें!");
  document.getElementById('startScreen').style.display = 'none';
  document.getElementById('quizScreen').style.display = 'block';
  showQuestion();
};

function showQuestion() {
  let q = questions[currentQuestion];
  document.getElementById('currentQ').textContent = currentQuestion + 1;
  document.getElementById('question').innerHTML = `<strong>${q.q}</strong>`;
  let html = "";
  q.o.forEach((opt, i) => {
    html += `<label class="option"><input type="radio" name="ans" value="${i}"> ${opt}</label>`;
  });
  document.getElementById('options').innerHTML = html;
}

document.getElementById('nextBtn').onclick = () => {
  let selected = document.querySelector('input[name="ans"]:checked');
  if (!selected) return alert("कोई विकल्प चुनें!");
  selectedAnswers.push(parseInt(selected.value));
  if (selected.value == questions[currentQuestion].a) score++;
  currentQuestion++;
  if (currentQuestion < 30) showQuestion();
  else submitTest();
};

function submitTest() {
  let data = {
    name: studentInfo.name,
    class: studentInfo.class,
    roll: studentInfo.roll,
    score: score,
    percentage: (score*100/30).toFixed(2),
    correct: score,
    wrong: 30-score,
    answers: selectedAnswers.map((ans, i) => questions[i].o[ans])
  };

  fetch(WEB_APP_URL, {method: "POST", body: JSON.stringify(data), headers: {"Content-Type": "application/json"}})
  .then(() => {
    document.getElementById('quizScreen').style.display = 'none';
    document.getElementById('finalName').textContent = studentInfo.name;
    document.getElementById('finalScore').textContent = score + "/30";
    document.getElementById('finalPercent').textContent = data.percentage + "%";
    document.getElementById('resultScreen').style.display = 'block';
  });
}
</script>
</body>
</html>
